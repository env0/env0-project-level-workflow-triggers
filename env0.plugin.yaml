name: Project Level Workflow Triggers
icon: https://avatars.githubusercontent.com/u/46656519?s=200&v=4
inputs:
  downstream-environment:
    description: The downstream environment that will to be triggered
    required: true
run:
  exec: |
    echo https://api.env0.com/environments/${inputs.downstream-environment}/deployments
    echo $ENV0_ENVIRONMENT_ID
    echo $ENV0_API_KEY
    echo $ENV0_API_SECRET
    echo -n "$ENV0_API_KEY:$ENV0_API_SECRET" | base64
    curl --request POST \                                                                                                                                                                  ✔ ╱ 20:30:24  
     --url https://api.env0.com/environments/${inputs.downstream-environment}/deployments \
     --header 'authorization: Basic $( echo -n "$ENV0_API_KEY:$ENV0_API_SECRET" | base64)' \
     --header 'accept: application/json' \
     --header 'content-type: application/json' \
     --data '
       {
          "triggerName": "workflow",
          "upstreamEnvironmentId": "$ENV0_ENVIRONMENT_ID",
          "userRequiresApproval": false
       }'
