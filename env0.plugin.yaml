name: Project Level Workflow Triggers
icon: https://avatars.githubusercontent.com/u/46656519?s=200&v=4
inputs:
  downstream-environment:
    description: The downstream environment that will to be triggered
    required: true
run:
  exec: |
    curl --request POST --user $ENV0_API_KEY:$ENV0_API_SECRET \
     --url https://api.env0.com/environments/${inputs.downstream-environment}/deployments \
     --header 'accept: application/json' \
     --header 'content-type: application/json' \
     --data '
       {
          "triggerName": "workflow",
          "upstreamEnvironmentId": "\$ENV0_ENVIRONMENT_ID",
          "userRequiresApproval": false,
          "comment": "Trigged by a \$ENV0_DEPLOYMENT_TYPE action on \$ENV0_ENVIRONMENT_ID"
       }'